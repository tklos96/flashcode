<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/Grid/GridBoundaryConditions/OneRow/Grid_applyBCEdge.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_06beb580571d8da4bd59dee7afe6838a.html">Grid</a></li><li class="navelem"><a class="el" href="dir_6ebd658f09dc477c2be5d9168dd0f546.html">GridBoundaryConditions</a></li><li class="navelem"><a class="el" href="dir_a90169c4c4bc10a91fdc125d77d40fab.html">OneRow</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Grid_applyBCEdge.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;constants.h&quot;</code><br />
<code>#include &quot;Flash.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a93d3ecfba3e43e98cba877eef6d5ec18"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_grid_2_grid_boundary_conditions_2_one_row_2_grid__apply_b_c_edge_8_f90.html#a93d3ecfba3e43e98cba877eef6d5ec18">grid_applybcedge</a> (bcType, bcDir, guard, var, dataRow, face, gridDataStruct, secondCoord, thirdCoord)</td></tr>
<tr class="separator:a93d3ecfba3e43e98cba877eef6d5ec18"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a93d3ecfba3e43e98cba877eef6d5ec18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93d3ecfba3e43e98cba877eef6d5ec18">&#9670;&nbsp;</a></span>grid_applybcedge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine grid_applybcedge </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>bcType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>bcDir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>guard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>dataRow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>face</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>gridDataStruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>secondCoord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>thirdCoord</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>Grid_applyBCEdge(integer(IN) :: bcType, integer(IN) :: bcDir, integer(IN) :: guard, integer(IN) :: var, real(INOUT),dimension(:) :: dataRow(2*guard), integer(IN) :: face, integer(IN) :: gridDataStruct, real(in),OPTIONAL :: secondCoord, real(in),OPTIONAL :: thirdCoord)</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bcType</td><td>the type of boundary condition being applied to this face </td></tr>
    <tr><td class="paramname">bcDir</td><td>can take on values IAXIS,JAXIS or KAXIS. This is needed for handling the reflective boundary conditions. If bcDir=IAXIS, and boundary conditions are reflective, and X velocity is treated differently from all other variables. similarly if bcDir is JAXIS, then Y velocity is different. </td></tr>
    <tr><td class="paramname">guard</td><td>number of guardcells </td></tr>
    <tr><td class="paramname">var</td><td>The variable on which boundary conditions are applied It is used with bcDir for reflective boundary conditions to correctly handle velocities. This argument is redundant for all other variables. </td></tr>
    <tr><td class="paramname">dataRow</td><td>storage for the data being operated upon. </td></tr>
    <tr><td class="paramname">face</td><td>can take values LOW and HIGH, defined in constants.h to indicate whether to apply boundary on lowerface or upperface </td></tr>
    <tr><td class="paramname">gridDataStruct</td><td>integer value specifying data structure. </td></tr>
    <tr><td class="paramname">The</td><td>options are defined in constants.h and they are CENTER cell centered variables (unk or work for PM) (default) FACEX face centered variable on faces normal to IAXIS FACEY face centered variable on faces normal to JAXIS FACEZ face centered variable on faces normal to KAXIS </td></tr>
    <tr><td class="paramname">secondCoord,thirdCoord</td><td>scalar coordinate values in the coordinate directions perpendicular to the sweep direction. This is not needed for simple boundary condition types such as REFLECTIVE or OUTFLOW, but is provided so that more complex boundary conditions can make use of it. The meaning depends on the sweep direction bcDir as follows bcDir | secondCoord thirdCoord </td></tr>
    <tr><td class="paramname">NAME</td><td>Grid_applyBCEdge</td></tr>
  </table>
  </dd>
</dl>
<p>DESCRIPTION</p>
<p>Applies the boundary conditions to a given vector. This routine applies the boundary conditions on a given face (lowerface or upperface) of a given vector. If (face=LOW)dataRow(1:guard) = boundary values If (face=HIGH) dataRow(guard+1:2*guard) = boundary values</p>
<p>The reason why information about direction and variable is included in this interface is because velocities need to be treated specially for REFLECTING boundary conditions. if bcDir=IAXIS, then the variable VELX_VAR is treated differently, same with VELY_VAR if bcDir=JAXIS and VELZ_VAR if bcDir=KAXIS. This special treatment is currently only done if gridDataStruct=CENTER (face variables are assumed not to be velocities). All supported mesh packages extract the vector passed in through the argument "dataRow" from the appropriated blocks, and send it to this routine for boundary calculation. This routine currently calculates REFLECTING and OUTFLOW boundaries. The PERIODIC boundary is calculated by default when the blocks are exchanging data with each other.</p>
<p>If the user wishes to apply different boundary conditions, they should make a copy of this routine in their given Simulation setup and implement their specific boundary.</p>
<pre class="fragment">                      IAXIS   |    Y(j) *            Z(k) **
                      JAXIS   |    X(i)              Z(k) **
                      KAXIS   |    X(i)              Y(j)
                     *)  if NDIM &gt; 1
                     **) if NDIM &gt; 2
                     These dummy arguments are ignored (and an implementation
                     of this interface should not attempt to access them) if
                     they do not make sense based on the dimensionality of
                     the problem.
                     These are either coordinates of cell centers or of
                     face centers, as appropriate depending on gridDataStruct.
</pre><p> NOTES </p><pre class="fragment">      This routine is common to all the mesh packages supported
      The mesh packages extract the small vector relevant to
      boundary conditions calculations from their Grid data 
      structures. If users wish to apply a different but simple
      directional boundary condition, they can replace this routine.
      More complex boundary conditions support will come in 
      future releases. In the meantime, users could use the
      Grid_applyBC.F90 file as a template. That file is currently
      used only for some Grid implementations (UG and Paramesh2, not
      for Paramesh 4), but gives a good outline for handling complex
      boundary conditions.
</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
