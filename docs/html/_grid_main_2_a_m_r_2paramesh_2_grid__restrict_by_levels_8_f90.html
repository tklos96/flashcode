<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/Grid/GridMain/AMR/paramesh/Grid_restrictByLevels.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_06beb580571d8da4bd59dee7afe6838a.html">Grid</a></li><li class="navelem"><a class="el" href="dir_a5ba4d35013f375122597140872d1634.html">GridMain</a></li><li class="navelem"><a class="el" href="dir_05ae419e4599d04cada32fb260516b32.html">AMR</a></li><li class="navelem"><a class="el" href="dir_dc00a9966eb127812b09432c10e25e84.html">paramesh</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Grid_restrictByLevels.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a98906971ed9705052ffc1016c856c619"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_grid_main_2_a_m_r_2paramesh_2_grid__restrict_by_levels_8_f90.html#a98906971ed9705052ffc1016c856c619">grid_restrictbylevels</a> (gridDataStruct, fromLevel, toLevel, checkFinestLevel, maskSize, mask)</td></tr>
<tr class="separator:a98906971ed9705052ffc1016c856c619"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a98906971ed9705052ffc1016c856c619"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98906971ed9705052ffc1016c856c619">&#9670;&nbsp;</a></span>grid_restrictbylevels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine grid_restrictbylevels </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>gridDataStruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>fromLevel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>toLevel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>checkFinestLevel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>maskSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>call Grid_restrictByLevels(integer(IN) :: gridDataStruct, integer(IN) :: fromLevel, integer(IN) :: toLevel, optional,logical(IN) :: checkFinestLevel, optional,integer(IN) :: maskSize, optional,logical(IN) :: mask(*))</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gridDataStruct</td><td>integer constant, defined in "constants.h", indicating which grid data structure variable's cell data to update. Paramesh has 5 data structures for grid variables, the first four include all physical variables defined on the mesh. The fifth one includes a single variable. unk cell centered, facex,facey,facez face centered along i,j,k direction respectively work cell centered, single variable. valid values of gridDataStruct are CENTER unk only WORK work !! valid only for Paramesh </td></tr>
    <tr><td class="paramname">May</td><td>also be supported in PM3/PM4 FACES facex,facey and facez FACEX facex FACEY facey FACEZ facez CENTER_FACES unk as well as facex,facey, and facez in current implementation of PM2 and UG, this is equivalent to CENTER </td></tr>
    <tr><td class="paramname">fromLevel</td><td>refinement level where the sweep should start, the finest level. It can be given as </td></tr>
    <tr><td class="paramname">a</td><td>negative integer, meaning a refinement level relative </td></tr>
    <tr><td class="paramname">anywhere</td><td>on the grid; the highest realized level is 1, </td></tr>
    <tr><td class="paramname">the</td><td>next coarse level is 2, etc. </td></tr>
    <tr><td class="paramname">toLevel</td><td>refinement level where the sweep should end, the coarsest level. Can be given as a positive integer, 0, or a negative integer, where the meaning is as described for forLevel. If toLevel indicates a level equal to or higher (i.e., finer) than fromLevel, no restriction will take place. </td></tr>
    <tr><td class="paramname">checkFinestLevel</td><td>whether to check for the finest level that is realized on the grid by an initial MPI_ALLREDUCE operation. Default is true. If set to false, the code may unnecessarily sweep over nonexistent levels. Note the this check will be done anyway if a negative fromLevel or toLevel is specified. </td></tr>
    <tr><td class="paramname">maskSize</td><td>the size of the mask array. It is an optional argument. </td></tr>
    <tr><td class="paramname">mask</td><td>This is an optional argument. If this argument is missing, the routine assumes that all variables in the specified data structure should get updated. </td></tr>
    <tr><td class="paramname">If</td><td>it is present, it is a one dimensional logical array with indices correspoding to variables in the grid data structures. If a variable should have its cells updated, the corresponding element in "mask" is true, otherwise it is false.</td></tr>
  </table>
  </dd>
</dl>
<p>NAME Grid_restrictByLevels</p>
<p>DESCRIPTION</p>
<p>Update solution data by a restriction sweep from blocks at refinement level given by fromLevel to refinement level toLevel.</p>
<p>The argument "gridDataStruct" can take on one of several valid values to determine a specific grid data structure on which to apply the data restriction operation. The currently available options are listed with the arguments. User code will probably use either CENTER as the option, with a mask selecting one or a few variables, or use WORK.</p>
<pre class="fragment">           as in the runtime parameters lrefine_min, lrefine_max, etc.,
           i.e., 1 means the refinement level of the root block(s).
           to the highest refinement level that is currently realized
</pre><p> EXAMPLE</p>
<p>#include "Flash.h" #include "constants.h"</p>
<p>call Grid_restrictByLevels( CENTER, 5, 3)</p>
<p>This call will update UNK data in interior cells of all non-LEAF blocks at refinement levels 4 and 3, by a restriction sweep based on LEAF blocks at refinement levels 5 and 4 in regions of the domain where such blocks exists and based on the data in non-LEAF blocks at level 5 elsewhere.</p>
<p>EXAMPLE 2</p>
<p>#include "Flash.h" #include "constants.h"</p>
<p>call Grid_restrictByLevels( WORK, 5, 3)</p>
<p>This call ...</p>
<p>EXAMPLE 3</p>
<p>#include "Flash.h" #include "constants.h"</p>
<p>logical :: restrictMask(NUNK_VARS)</p>
<p>restrictMask = .FALSE. restrictMask(DENS_VAR) = .TRUE. call Grid_restrictByLevels( CENTER, 5, 3, maskSize=NUNK_VARS, mask=restrictMask)</p>
<p>This call ...</p>
<p>SIDE EFFECTS</p>
<p>After this function returns, all parent and ancestor blocks at refinement levels between fromLevel (exclusive) and toLevel (inclusive) will have updated solution data for the variables determined by the gridDataStruct and mask dummy arguments, based on restriction operations beginning with blocks at either a refinement level of fromLevel or coarser LEAF blocks (in regions where the LEAF blocks are less refined than fromLevel) and sweeping up the grid tree.</p>
<p>Data in variables not selected by gridDataStruct and mask will be either unchanged (in the PARAMESH Grid [as well as UG]) or may also have undergone restriction (in Grid implementations where masks are ignored).</p>
<p>NOTES</p>
<p>Face variables not tested / not expected to work.</p>
<p>Restriction, as we use the term, refers only to changing the solution data on blocks, while leaving the structure of the Grid (existence of blocks, AMR tree structure) unchanged. In particular, no blocks are removed by "restriction".</p>
<p>Guard cells are not updated.</p>
<p>With a uniform grid, all calls are no-ops.</p>
<p>Constants CENTER, WORK, etc. are defined in constants.h . </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
