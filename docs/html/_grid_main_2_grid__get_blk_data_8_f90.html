<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/Grid/GridMain/Grid_getBlkData.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_06beb580571d8da4bd59dee7afe6838a.html">Grid</a></li><li class="navelem"><a class="el" href="dir_a5ba4d35013f375122597140872d1634.html">GridMain</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Grid_getBlkData.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa1d044e679dfbe747f12ea1d699a5890"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_grid_main_2_grid__get_blk_data_8_f90.html#aa1d044e679dfbe747f12ea1d699a5890">grid_getblkdata</a> (blockDesc, gridDataStruct, structIndex, beginCount, startingPos, datablock, dataSize)</td></tr>
<tr class="separator:aa1d044e679dfbe747f12ea1d699a5890"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aa1d044e679dfbe747f12ea1d699a5890"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1d044e679dfbe747f12ea1d699a5890">&#9670;&nbsp;</a></span>grid_getblkdata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine grid_getblkdata </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structblock__metadata_1_1block__metadata__t.html">block_metadata_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>blockDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>gridDataStruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>structIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>beginCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(mdim), intent(in)&#160;</td>
          <td class="paramname"><em>startingPos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(datasize(1), datasize(2), datasize(3)), intent(out)&#160;</td>
          <td class="paramname"><em>datablock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(mdim), intent(in)&#160;</td>
          <td class="paramname"><em>dataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>Grid_getBlkData(type(block_metadata_t)(IN) :: block, integer(IN) :: gridDataStruct, integer(IN) :: structIndex, integer(IN) :: beginCount, integer(IN) :: startingPos(MDIM), real(OUT) :: datablock(dataSize(1),dataSize(2), dataSize(3)), integer(IN) :: dataSize(3))</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block</td><td>block metadata </td></tr>
    <tr><td class="paramname">gridDataStruct</td><td>integer value specifying the type of data desired. Valid options are either one of the Grid data structures, or one of the derived quantities such as the cell volume or the cell area. </td></tr>
    <tr><td class="paramname">The</td><td>options are defined in constants.h and they are CENTER cell centered variables FACEX face centered variable on faces along IAXIS FACEY face centered variable on faces along JAXIS FACEZ face centered variable on faces along IAXIS WORK single, cell centered variable, valid only for paramesh SCRATCH scratch space that can fit cell and face centered variables SCRATCH_CTR scratch space for cell centered variables SCRATCH_FACEX scratch space facex variables SCRATCH_FACEY scratch space facey variables SCRATCH_FACEZ scratch space facez variables CELL_VOLUME volumes of specified cells CELL_FACEAREA face area for the specified cells on specified face </td></tr>
    <tr><td class="paramname">structIndex</td><td>integer value that provides index into the specified data structure. When gridDataStruct is one of the grid data structures structIndex translates to a specific variable in that </td></tr>
    <tr><td class="paramname">data</td><td>structure, for example DENS_VAR or PRES_VAR (define in Flash.h) if gridDataStruct = CENTER. For gridDataStruct=CELL_VOLUME it has no meaning For gridDataStruct = CELL_FACEAREA, it can take one of (ILO_FACE,IHI_FACE,JLO_FACE,JHI_FACE,KLO_FACE,KHI_FACE) defined in constants.h </td></tr>
    <tr><td class="paramname">beginCount</td><td>tells the routine where to start index counting. beginCount can be set to INTERIOR or EXTERIOR. If INTERIOR is specified guardcell indices are not included and index 1 is the first interior cell. If EXTERIOR is specified the first index, 1, is the left most guardcell. See example below for more explanation. (For most of the FLASH architecture code, we use EXTERIOR. Some physics routines, however, find it helpful only to work on the internal parts of the blocks (without guardcells) and wish to keep loop indicies going from 1 to NXB without having to worry about finding the correct offset for the number of guardcells.) Can also be GLOBALIDX1 for global indexing, or DEFAULTIDX. (INTERIOR, EXTERIOR, etc. are defined in constants.h) </td></tr>
    <tr><td class="paramname">startingPos(MDIM)</td><td>specifies the starting position of the block being fetched startingPos(1) = i startingPos(2) = j startingPos(3) = k If a problem is 2 dimensions startingPos(3) is irrelevant and ignored. For 1d problems startingPos(2) and startingPos(3) are ignored. </td></tr>
    <tr><td class="paramname">datablock</td><td>a real 3 dimensional array containing the data returned The dimensions for datablock are datablock(irange, jrange, krange) Various compilers require the dimensions of datablock to be specified explicitly. They are defined by the next argument "dataSize". </td></tr>
    <tr><td class="paramname">dataSize</td><td>an integer array specifying the dimensions for datablock dataSize(1) holds the number of cells returned in the i direction dataSize(2) holds the number of cells returned in the j direction if 1 dim problem set dataSize(2) = 1 dataSize(3) holds the number of cells returned in the k direction if 1 or 2 dim problem set dataSize(3) = 1</td></tr>
  </table>
  </dd>
</dl>
<p>NAME Grid_getBlkData</p>
<p>DESCRIPTION</p>
<p>This routine allows the user to get an entire block or any contiguous part of a block of data depending on the arguments passed. The data could be either a single variable in one of the grid data structures such as cell centered/face centered/scratch, or it could be quantities derived from the size of the cell, such as cell volume/ face area for all the cells in the specified portion of the block</p>
<p>The user is also allowed to specify if index counting should begin at the exterior edge of the block (that is including guardcells), or the interior edge of the block.</p>
<p>For 3 dimensional problems, a 3d block is returned. For 2 dimensional problems, a 2d block/plane is returned. For 1 dimensional problems, a 1d block/row is returned.</p>
<p>EXAMPLE</p>
<pre class="fragment">EXAMPLE 1:  
Here is a 3d block example getting the entire block of cell centered 
data, including guardcells,
for each block on a local processor.  beginCount is set to EXTERIOR
meaning that the first cell of the block including guardcells is 
index = 1.  If in this example, NGUARD = 4 then position 5 is the
first interior cell in a dimension.

(Can't really draw 3d for this example, but this
 picture is meant to help show where 
 counting begins when "beginCount" is set to EXTERIOR)

 j

16         - - - - - - - -  
15         - - - - - - - - 
14         - - - - - - - - 
13         - - - - - - - - 
12 - - - -|-|-|-|-|-|-|-|-|- - - -
11 - - - -|-|-|-|-|-|-|-|-|- - - -
10 - - - -|-|-|-|-|-|-|-|-|- - - -
 9 - - - -|-|-|-|-|-|-|-|-|- - - -
 8 - - - -|-|-|-|-|-|-|-|-|- - - -
 7 - - - -|-|-|-|-|-|-|-|-|- - - -
 6 - - - -|-|-|-|-|-|-|-|-|- - - -
 5 - - - -|-|-|-|-|-|-|-|-|- - - -
 4         - - - - - - - - 
 3         - - - - - - - - 
 2         - - - - - - - - 
 1         - - - - - - - - 
</pre><p> i 1 2 3 4 5 6 7 8 9 10111213141516</p>
<p>#include "Flash.h" #include "constants.h"</p>
<p>...</p>
<p>integer :: startingPos(MDIM) integer :: dataSize(3) integer :: blockID real :: dataBlock(:,:,:) </p><pre class="fragment">startingPos(1) = 1 !getting the entire extent of dim   
startingPos(2) = 1 !getting the entire extent of dim
startingPos(3) = 1 !getting the entire extent of dim

dataSize(1) = blkLimitsGC(IAXIS) !This is equivalent to NXB + 2*NGUARD 
                                 !in FIXEDBLOCKSIZE mode
dataSize(2) = blkLimitsGC(JAXIS) !This is equivalent to NYB + 2*NGUARD
                                 !in FIXEDBLOCKSIZE mode
dataSize(3) = blkLimitsGC(KAXIS) !This is equivalent to NZB + 2*NGUARD
                                 !in FIXEDBLOCKSIZE mode

allocate(datablock(dataSize(1), dataSize(2), dataSize(3)))

do blockID = 1, localNumBlocks

   call Grid_getBlkData(blockID, CENTER, DENS_VAR, EXTERIOR, &amp;
                     startingPos, dataBlock, dataSize)

end do
</pre><p>EXAMPLE 2: In this 2d block example we will get cell volume of only a portion of the interior part of a block for each block on the local processor. beginCount is set to INTERIOR, meaning that all the startPos indices will start where index 1 is the first interior cell of the block. In this example we will get only the last 2 columns of interior cells. i start position = 7, j start position = 1. (Because this is only a 2d problem Grid_getPlaneData could also be used to get these cells.)</p>
<p>(Hard to draw, but this is the idea, stars (*) are the cells to return. Notice where index counting starts when beginCount is set to INTERIOR)</p>
<hr/>
<hr/>
<hr/>
<p> j - - - - - - - - 8 -&mdash;|-|-|-|-|-|-|*|*|-&mdash; 7 -&mdash;|-|-|-|-|-|-|*|*|-&mdash; 6 -&mdash;|-|-|-|-|-|-|*|*|-&mdash; 5 -&mdash;|-|-|-|-|-|-|*|*|-&mdash; 4 -&mdash;|-|-|-|-|-|-|*|*|-&mdash; 3 -&mdash;|-|-|-|-|-|-|*|*|-&mdash; 2 -&mdash;|-|-|-|-|-|-|*|*|-&mdash; 1 -&mdash;|-|-|-|-|-|-|*|*|-&mdash;</p>
<hr/>
<hr/>
<hr/>
<hr/>
<p> i 1-2-3-4 5-6-7-8</p>
<pre class="fragment">#include "Flash.h"
#include "constants.h"

...

  integer ::    startingPos(MDIM)
  integer ::    dataSize(3)
  integer ::    blockID
  real    ::    dataBlock(:,:,:)

      startingPos(1) = 7    
      startingPos(2) = 1
      startingPos(3) = 1 !value ignored since only 2d

      dataSize(1) = 2 !just getting 2 cells in the i dir
      dataSize(2) = 8 !just getting 8 cells in the j dir
      dataSize(3) = 1 !needs to be set to 1, since only 2d problem

      allocate(datablock(dataSize(1), dataSize(2), dataSize(3)))

      do blockID = 1, localNumBlocks

         call Grid_getBlkData(blockID, CELL_VOLUME, 0, INTERIOR, &amp;
                           startingPos, dataBlock, dataSize)

      end do
</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
