<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/Grid/GridParticles/GridParticlesMapToMesh/ParticlesOwned/Paramesh/MoveSieve/Grid_mapParticlesToMesh.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_06beb580571d8da4bd59dee7afe6838a.html">Grid</a></li><li class="navelem"><a class="el" href="dir_3663af0769abe994a06b6745dc09c949.html">GridParticles</a></li><li class="navelem"><a class="el" href="dir_280e392330c2306bbf95358037983a69.html">GridParticlesMapToMesh</a></li><li class="navelem"><a class="el" href="dir_bdb741849028512a0801e27210ab8b5a.html">ParticlesOwned</a></li><li class="navelem"><a class="el" href="dir_b3438469cac9661eda7b7aefe3c1b4b3.html">Paramesh</a></li><li class="navelem"><a class="el" href="dir_03cb3c0c11788cb3624a0a5a7b061535.html">MoveSieve</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Grid_mapParticlesToMesh.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a45a641514ef561dbef6a74f1e73cb063"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_grid_particles_2_grid_particles_map_to_mesh_2_particles_owned_2_paramesh_2_move_sieve_2_grid__map_particles_to_mesh_8_f90.html#a45a641514ef561dbef6a74f1e73cb063">grid_mapparticlestomesh</a> (particles, part_props, numParticles, maxParticlesPerProc, propPart, varGrid, mode, ptInfo)</td></tr>
<tr class="separator:a45a641514ef561dbef6a74f1e73cb063"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a45a641514ef561dbef6a74f1e73cb063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45a641514ef561dbef6a74f1e73cb063">&#9670;&nbsp;</a></span>grid_mapparticlestomesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine grid_mapparticlestomesh </td>
          <td>(</td>
          <td class="paramtype">real, dimension(part_props,numparticles), intent(inout)&#160;</td>
          <td class="paramname"><em>particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>part_props</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>numParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>maxParticlesPerProc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>propPart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>varGrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>ptInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>call Grid_mapParticlesToMesh(real(INOUT) :: particles(part_props,numParticles), integer(IN) :: part_props, integer(IN) :: numParticles, integer(IN) :: maxParticlesPerProc, integer(IN) :: propPart, integer(IN) :: varGrid, OPTIONAL,integer(IN) :: mode, OPTIONAL,integer(IN) :: ptInfo)</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particles</td><td>List of particles. It is two dimensional real array, the first dimension represents each particle's properties, and second dimension is index to particles. </td></tr>
    <tr><td class="paramname">part_props</td><td>number of properties in the particles datastructure </td></tr>
    <tr><td class="paramname">numParticles</td><td>While coming in it contains the current number of particles mapped to this processor. After all the data structure movement, the number of local particles might change, and the new value is put back into it </td></tr>
    <tr><td class="paramname">maxParticlesPerProc</td><td>The size of the buffer allocated for particles at compile time. This is the largest number of particles that a simulation can have on one processor at any time. </td></tr>
    <tr><td class="paramname">varGrid</td><td>Index of gridded variable to receive interpolated quantity </td></tr>
    <tr><td class="paramname">propPart</td><td>Index of particle attribute to interpolate onto the mesh </td></tr>
    <tr><td class="paramname">mode</td><td>(Optional) If zero (default), zero varGrid first; if nonzero, do not zero varGrid first </td></tr>
    <tr><td class="paramname">ptInfo</td><td>(Optional) additional info to pass to the Particles unit in some calls, for debugging</td></tr>
  </table>
  </dd>
</dl>
<p>NAME Grid_mapParticlesToMesh</p>
<p>DESCRIPTION</p>
<p>Routine to map a quantity defined for particles onto the mesh. The approximate steps are:</p><ol type="1">
<li>Determine the size of the send / receive buffer. This will eventually contain the guard cells that need to be delivered to an off-processor block. (Whilst determining this size, store valuable information in a data-structure named "gr_ptDomain".)</li>
<li>Loop over each block on this processor. If it contains at least one particle then smear these particles over a temporary block. The details of the smear depend on the particle mapping scheme, e.g. NGP, CIC, TSC. The temporary block is contiguous in memory to improve performance.</li>
<li>Apply external boundary conditions to the temporary block.</li>
<li>Copy internal section of temporary block into the source block.</li>
<li><p class="startli">The boundaries of the temporary block belong to another block on the source processor or a block on another processor. Perform any prolongation / restriction for when the touching blocks are at different resolutions.</p>
<p class="startli">Copy the guard cells directly to another block on this processor, or place the guard cells in the send / receive buffer.</p>
</li>
<li>Send the send buffer to another processor, and receive from another processor.</li>
</ol>
<p>NOTES This subroutine assumes that each particle is associated with the correct block. To verify whether this is the case, the application should be resetup with -defines=DEBUG_GRIDPARTICLES and then rebuilt. This ensures that the particle movement in Grid_moveParticles is correct. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
