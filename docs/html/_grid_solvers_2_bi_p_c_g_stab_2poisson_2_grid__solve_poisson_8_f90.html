<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/Grid/GridSolvers/BiPCGStab/poisson/Grid_solvePoisson.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_06beb580571d8da4bd59dee7afe6838a.html">Grid</a></li><li class="navelem"><a class="el" href="dir_35d2cf0c04a4c82d90da4ab0f882caba.html">GridSolvers</a></li><li class="navelem"><a class="el" href="dir_83dc98395eacffac4c68511a2331356d.html">BiPCGStab</a></li><li class="navelem"><a class="el" href="dir_a2c4e25d6e4882cc724d749a3f73dcb1.html">poisson</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Grid_solvePoisson.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;Flash.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a0ca8c5f7b2b9f836c5314a0d99070f46"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_grid_solvers_2_bi_p_c_g_stab_2poisson_2_grid__solve_poisson_8_f90.html#a0ca8c5f7b2b9f836c5314a0d99070f46">grid_solvepoisson</a> (iSoln, iSrc, bcTypes, bcValues, poisFact)</td></tr>
<tr class="separator:a0ca8c5f7b2b9f836c5314a0d99070f46"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a0ca8c5f7b2b9f836c5314a0d99070f46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ca8c5f7b2b9f836c5314a0d99070f46">&#9670;&nbsp;</a></span>grid_solvepoisson()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine grid_solvepoisson </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iSoln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iSrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(6), intent(in)&#160;</td>
          <td class="paramname"><em>bcTypes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(2,6), intent(in)&#160;</td>
          <td class="paramname"><em>bcValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>poisFact</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>call Grid_solvePoisson(integer(IN) :: iSoln, integer(IN) :: iSrc, integer(IN) :: bcTypes(6), real(IN) :: bcValues(2,6), real(INOUT) :: poisFact)</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iSoln</td><td>the index for the solution variable. The solution is written directly into this variable. </td></tr>
    <tr><td class="paramname">iSrc</td><td>the index of the source variable (density when used for self </td></tr>
    <tr><td class="paramname">bcTypes</td><td>the boundary condition type; only the first entry is used. Only the first 2*NDIM elements are significant. They are interpreted in the order (X left, X right, Y left, Y right, Z left, Z right). </td></tr>
    <tr><td class="paramname">Valid</td><td>values are GRID_PDE_BND_PERIODIC (1) GRID_PDE_BND_DIRICHLET (2) (homogeneous or constant Dirichlet) GRID_PDE_BND_NEUMANN (3) (homogeneous or constant Neumann) </td></tr>
    <tr><td class="paramname">GRID_PDE_BND_ISOLATED</td><td>(0) NOT IMPLEMENTED HERE </td></tr>
    <tr><td class="paramname">bcValues</td><td>Fixed values at boundary for Dirichlet and Neumann boundary conditions. If Robin, then bcValues(1,*) holds Dirichlet and bcValues(2,*) Neumann conditions; if Neumann or Dirichlet, then bcValues(1,*) holds Neumann or Dirichlet values and bcValues(2,*) goes unused </td></tr>
    <tr><td class="paramname">poisFact</td><td>Constant Poisson factor. Used to scale the source function. For example, for gravity, poisFact = 4*pi*G.</td></tr>
  </table>
  </dd>
</dl>
<p>NAME</p>
<p>Grid_solvePoisson</p>
<p>DESCRIPTION</p>
<p>Driver routine for the BiPCGStab Poisson solver.</p>
<p>NOTES</p>
<p>The symbols listed above for bcTypes are declared as FORTRAN PARAMETERS in the module Grid_interfaces. Code using this interface should refer to that module with a USE statement, like this:</p>
<p>use Grid_interface, ONLY : GRID_PDE_BND_PERIODIC, GRID_PDE_BND_NEUMANN, &amp; GRID_PDE_BND_ISOLATED, GRID_PDE_BND_DIRICHLET, &amp; Grid_solvePoisson</p>
<p>Most implementations only support a limited subset of boundary condition types. Some implementations require that all significant elements of bcTypes are the same. (That is always the case for GRID_PDE_BND_ISOLATED.) Even if an implementation supports combinations of different boundary conditions on different sides of the domain, the types at left and right sides for the same axis direction will usually have to be the samme.</p>
<p>Support in some implementations provided with FLASH4:</p>
<p>GridSolvers/Multipole: GRID_PDE_BND_ISOLATED</p>
<p>GridSolvers/Multigrid (simple): GRID_PDE_BND_PERIODIC, GRID_PDE_BND_DIRICHLET(hom.), GRID_PDE_BND_NEUMANN(hom.)(?) (same type in all directions), or GRID_PDE_BND_ISOLATED (requires Paramesh as Grid with NBlockX==NBlockY==NBlockZ==1) GridSolvers/Pfft: GRID_PDE_BND_PERIODIC, GRID_PDE_BND_DIRICHLET(hom.), GRID_PDE_BND_NEUMANN(hom.) in various combinations, depending on GridSolvers/Pfft subdirectory (i.e. implementation configured in) (requires UG in pencil shape or Paramesh as Grid) GridSolvers/Multigrid hybrid with Pfft: GRID_PDE_BND_PERIODIC, GRID_PDE_BND_DIRICHLET, GRID_PDE_BND_NEUMANN in various combinations, or GRID_PDE_BND_ISOLATED (requires Paramesh as Grid) GridSolvers/BiPCGStab preconditioned with MC multigrid: GRID_PDE_BND_PERIODIC, GRID_PDE_BND_DIRICHLET(hom.), GRID_PDE_BND_NEUMANN(hom.) in various combinations (requires Paramesh as Grid) GridSolvers/BiPCGStab preconditioned with (HG) multigrid: GRID_PDE_BND_PERIODIC, GRID_PDE_BND_DIRICHLET(hom.), GRID_PDE_BND_NEUMANN(hom.) in various combinations (requires Paramesh as Grid) GridSolvers/BiPCGStab preconditioned with HYPRE: Status unknown </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
