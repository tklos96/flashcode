<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/Grid/GridSolvers/Multigrid/Grid_solvePoisson.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_06beb580571d8da4bd59dee7afe6838a.html">Grid</a></li><li class="navelem"><a class="el" href="dir_35d2cf0c04a4c82d90da4ab0f882caba.html">GridSolvers</a></li><li class="navelem"><a class="el" href="dir_2b9ab751dfe17b7da08cde8a54556820.html">Multigrid</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Grid_solvePoisson.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;Multigrid.h&quot;</code><br />
<code>#include &quot;Flash.h&quot;</code><br />
<code>#include &quot;constants.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a779b37499519d870773644d01afcb5e7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_grid_solvers_2_multigrid_2_grid__solve_poisson_8_f90.html#a779b37499519d870773644d01afcb5e7">grid_solvepoisson</a> (iSoln, iSrc, bcTypes, bcValues, poisfact)</td></tr>
<tr class="separator:a779b37499519d870773644d01afcb5e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a779b37499519d870773644d01afcb5e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a779b37499519d870773644d01afcb5e7">&#9670;&nbsp;</a></span>grid_solvepoisson()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine grid_solvepoisson </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iSoln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iSrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(6), intent(in)&#160;</td>
          <td class="paramname"><em>bcTypes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(2,6), intent(in)&#160;</td>
          <td class="paramname"><em>bcValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>poisfact</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>call Grid_solvePoisson(integer(IN) :: iSoln, integer(IN) :: iSrc, integer(IN) :: bcTypes(6), real(IN) :: bcValues(2,6), real(INOUT) :: poisfact)</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iSoln</td><td>the index for the solution variable (potential when used for self </td></tr>
    <tr><td class="paramname">iSrc</td><td>the index of the source variable (density when used for self </td></tr>
    <tr><td class="paramname">bcTypes</td><td>the boundary condition type; only the first entry is used to determine whether all boundaries should be handled as isolated. </td></tr>
    <tr><td class="paramname">the</td><td>following conditions are presently supported MG_BND_PERIODIC MG_BND_ISOLATED MG_BND_DIRICHLET MG_BND_NEUMANN could most likely be easily implemented </td></tr>
    <tr><td class="paramname">bcValues</td><td>an unused argument used to keep the interface standard </td></tr>
    <tr><td class="paramname">poisfact</td><td>the scaling factor for the eventual solution for gravity this is 4*pi*G RESULT The variable at iSoln contains the solution to L(u) = rho for the given boundary value setup </td></tr>
    <tr><td class="paramname">IMGM_VAR</td><td>grid variable to store the image mass </td></tr>
    <tr><td class="paramname">IMGP_VAR</td><td>grid variable to store the image potential </td></tr>
    <tr><td class="paramname">ISLS_VAR</td><td>residual grid variable </td></tr>
    <tr><td class="paramname">ICOR_VAR</td><td>correction grid variable</td></tr>
  </table>
  </dd>
</dl>
<p>NAME Grid_solvePoisson</p>
<p>DESCRIPTION</p>
<p>This routine solves Poisson's for assorted boundary types using the Huang-Greengard multilevel solver. It uses the James' image-mass method to handle isolated boundaries.</p>
<p>NOTES</p>
<p>It is currently assumed in this implementation DEV: But not checked! - KW that boundary condition types at all sides of the domain are the same. What this means to the user is that only the first value in bcTypes is checked here, and may be assumed to give the type of boundary condition for all 2*NDIM directions. Presently, the FFT package used only supports the same transform done in all directions. Using something different, such as PFFT as the top level, should remedy this.</p>
<p>The all-sides-the-same boundary values could be for the sake of the top-level FFT solve (but the dummy argument is not actually used in this version).</p>
<p>SEE ALSO</p>
<p>gr_hgSolve, gr_isoImageMass </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
