<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/Grid/GridSolvers/Multipole_new/gr_mpoleSetRadialBinData.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_06beb580571d8da4bd59dee7afe6838a.html">Grid</a></li><li class="navelem"><a class="el" href="dir_35d2cf0c04a4c82d90da4ab0f882caba.html">GridSolvers</a></li><li class="navelem"><a class="el" href="dir_e2d78af9a40e3adb3751a7973f6d2aa3.html">Multipole_new</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">gr_mpoleSetRadialBinData.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;gr_mpole.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a9cb263930f37c7ceb90c9fd56934ddcf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_grid_solvers_2_multipole__new_2gr__mpole_set_radial_bin_data_8_f90.html#a9cb263930f37c7ceb90c9fd56934ddcf">gr_mpolesetradialbindata</a> ()</td></tr>
<tr class="separator:a9cb263930f37c7ceb90c9fd56934ddcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a9cb263930f37c7ceb90c9fd56934ddcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cb263930f37c7ceb90c9fd56934ddcf">&#9670;&nbsp;</a></span>gr_mpolesetradialbindata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gr_mpolesetradialbindata </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>gr_mpoleSetRadialBinData ()</p>
<p></p>
<p>NAME</p>
<p>gr_mpoleSetRadialBinData</p>
<p>DESCRIPTION</p>
<p>Sets all radial bin data that is necessary for moment and potential evaluation. It currently computes the maximum radial value for each bin and the bin damping factors. The damping factors are used to avoid possible overflow or underflow when evaluating the regular and irregular solid harmonic functions via recursion. When using these factors the recursion becomes 'normalized' in the sense that the highest L-valued solid harmonic functions are close to unity.</p>
<p>For a given radial bin index Q outside of the inner zone, the maximum and minimum radius associated with that bin is calculated using the radial zone data provided. From these radii the damping factors are evaluated as follows, using the maximum angular momentum value L of the problem: </p><pre class="fragment">            regular solid harmonic = (  L-th root of L!) / rmax
          irregular solid harmonic = (L+1-th root of L!) / rmin
</pre><p>The x,y,z coordinates will be multiplied by the corresponding damping factors during application of the recursions. The approximations used for the roots of the factorials follow from Stirlings factorial approximation and are: </p><pre class="fragment">(  L-th root of L!) ~ (L/e) * (  2L-th root of 2*pi*L)
(L+1-th root of L!) ~ (L/e) * (2L+2-th root of 2*pi*e^2/L)
</pre><p>Here e = 2.7182818...and pi = 3.14159....</p>
<p>For a given radial bin index Q inside the inner zone, there is only one radius (call it rmax) associated with it, which is sitting in the array 'gr_mpoleInnerZoneDrRadii' in units of the inner zone atomic distance. The damping factors are evaluated as follows, using the maximum angular momentum value L of the problem: </p><pre class="fragment">            regular solid harmonic = (  L-th root of L!) / rmax
          irregular solid harmonic = (L+1-th root of L!) / rmax
</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
