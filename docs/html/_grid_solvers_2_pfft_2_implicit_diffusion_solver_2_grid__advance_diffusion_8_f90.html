<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/Grid/GridSolvers/Pfft/ImplicitDiffusionSolver/Grid_advanceDiffusion.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_06beb580571d8da4bd59dee7afe6838a.html">Grid</a></li><li class="navelem"><a class="el" href="dir_35d2cf0c04a4c82d90da4ab0f882caba.html">GridSolvers</a></li><li class="navelem"><a class="el" href="dir_6d0b4c1f565e8ee64627a278811801c6.html">Pfft</a></li><li class="navelem"><a class="el" href="dir_e89476b27700ca15d0cf55caec23f10c.html">ImplicitDiffusionSolver</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Grid_advanceDiffusion.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;Flash.h&quot;</code><br />
<code>#include &quot;constants.h&quot;</code><br />
<code>#include &quot;Pfft.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ac2ad821f1b4345f3566ad8c95b318252"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_grid_solvers_2_pfft_2_implicit_diffusion_solver_2_grid__advance_diffusion_8_f90.html#ac2ad821f1b4345f3566ad8c95b318252">grid_advancediffusion</a> (iVar, iSrc, iFactorB, iFactorA, bcTypes, bcValues, dt, chi, scaleFact, theta, solnIsDelta, iFactorC, iFactorD, pass)</td></tr>
<tr class="separator:ac2ad821f1b4345f3566ad8c95b318252"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ac2ad821f1b4345f3566ad8c95b318252"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2ad821f1b4345f3566ad8c95b318252">&#9670;&nbsp;</a></span>grid_advancediffusion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine grid_advancediffusion </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iSrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iFactorB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iFactorA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(6), intent(in)&#160;</td>
          <td class="paramname"><em>bcTypes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(2,6), intent(in)&#160;</td>
          <td class="paramname"><em>bcValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>chi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>scaleFact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>solnIsDelta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>iFactorC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>iFactorD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>pass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>call Grid_advanceDiffusion(integer(IN) :: iSoln, integer(IN) :: iSrc, integer(IN) :: iCond, integer(IN) :: iConstFact, integer(IN) :: bcTypes(6), real(IN) :: bcValues(2,6), real(IN) :: dt, real(IN) :: chi, real(IN) :: scaleFact, logical(IN) :: solnIsDelta, integer(IN), OPTIONAL :: pass)</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iSoln</td><td>The index for the solution variable (V, Temperature in heat conduction) </td></tr>
    <tr><td class="paramname">iSrc</td><td>discretized RHS (d/dx(B*dV/dx) + d/dy(B*dV/dy) + d/dx(B*dV/dz)) </td></tr>
    <tr><td class="paramname">iCond</td><td>The index of the diffusion coefficient (if used, otherwise -1) </td></tr>
    <tr><td class="paramname">iConstFact</td><td>The index of coefficient of temporal derivative (think A) rho*cv in Heat conduction. </td></tr>
    <tr><td class="paramname">bcTypes</td><td>Left and Right boundary condition type. Supports PERIODIC, OUTFLOW (tested). DIRICHLET,PNEUMAN (untested). </td></tr>
    <tr><td class="paramname">bcValues</td><td>an unused argument used to keep the interface standard. </td></tr>
    <tr><td class="paramname">dt</td><td>the time step. </td></tr>
    <tr><td class="paramname">chi</td><td>a factor in the heat diffusion equation, not used anymore. </td></tr>
    <tr><td class="paramname">scaleFact</td><td>the scaling factor for the eventual solution. </td></tr>
    <tr><td class="paramname">solnIsDelta</td><td>Is the solution only a delta that the caller has to apply to the temperature, rather than temperature itself. </td></tr>
    <tr><td class="paramname">pass</td><td>pass=1 order of directional sweep X-Y-Z, pass=2 order of directional sweep Z-Y-X.</td></tr>
  </table>
  </dd>
</dl>
<p>NAME Grid_advanceDiffusion</p>
<p>DESCRIPTION</p>
<p>This routine advances a diffusive operator (think head conduction) of the form </p><pre class="fragment">A * dV/dt = d/dx(B*dV/dx) + d/dy(B*dV/dy) + d/dx(B*dV/dz)
Heat conduction : rho*cv dT/dt = d/dx(kdT/dx) + ..      
</pre><p>NOTES</p>
<p>It is currently assumed in this implementation DEV: But not checked! - KW that boundary condition types at all sides of the domain are the same. What this means to the user is that only the first value in bcTypes is checked here, and may be assumed to give the type of boundary condition for all 2*NDIM directions.</p>
<p>SEE ALSO</p>
<p>Diffuse_advance1D </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
