<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/numericalTools/Interpolate/InterpolateMain/Interpolate_cubic1Dcoeffs.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_1e5049951a47af6c299d4f194035013b.html">numericalTools</a></li><li class="navelem"><a class="el" href="dir_eed35f7b641137479b7c948f38ceed3a.html">Interpolate</a></li><li class="navelem"><a class="el" href="dir_06550a40ae0b1b7c18d4f80098946ddc.html">InterpolateMain</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Interpolate_cubic1Dcoeffs.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a2248c5da2d337620e3e1c510df9a5f45"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_interpolate_main_2_interpolate__cubic1_dcoeffs_8_f90.html#a2248c5da2d337620e3e1c510df9a5f45">interpolate_cubic1dcoeffs</a> (numberOfLines, a)</td></tr>
<tr class="separator:a2248c5da2d337620e3e1c510df9a5f45"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a2248c5da2d337620e3e1c510df9a5f45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2248c5da2d337620e3e1c510df9a5f45">&#9670;&nbsp;</a></span>interpolate_cubic1dcoeffs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine interpolate_cubic1dcoeffs </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>numberOfLines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (1:4,*), intent(inout)&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>call Interpolate_cubic1Dcoeffs (integer, intent (in) :: numberOfLines, real, intent (inout) :: a (1:4,*))</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">numberOfLines</td><td>the number of lines to be treated </td></tr>
    <tr><td class="paramname">a</td><td>(i,j) i-th function/derivative (input) and expansion coefficient (output) of j-th line</td></tr>
  </table>
  </dd>
</dl>
<p>NAME</p>
<p>Interpolate_cubic1Dcoeffs</p>
<p>DESCRIPTION</p>
<p>Calculates the cubic expansion coefficients for a collection of lines. The cubic expansion reads, for one line, in terms of rescaled [0,1] x coordinates: </p><pre class="fragment">                           3          i
                  C (x) = sum  a (i) x
                          i=0
</pre><p>and is uniquely determined by specifying the following 2 values at each of the 2 endpoints of the line (4 constraints for 4 unknown expansion coefficients): </p><pre class="fragment">                       C (x)        (value of function at endpoints)
                        d/dx        (1st rescaled x-derivative)
</pre><p>The line itself is defined by its 0 and 1 coordinates of its 2 endpoints:</p>
<pre class="fragment">                              |-----------|---- x
                              0           1
</pre><p>In order to obtain the function and global derivative values at a global position (X) inside the line, one must first form the rescaled x coordinate: </p><pre class="fragment">                             x = (X - X0) / (X1 - X0)
</pre><p>where X0 and X1 are the lower and upper global square x coordinates:</p>
<pre class="fragment">                              |-----------|---- X
                              X0          X1
</pre><p>The function and global derivative (using the chain rule) values are then:</p>
<pre class="fragment">                          3          i
                 C (X) = sum  a (i) x
                         i=0

                          3              i-1
                  d/dX = sum  i * a (i) x    * dx/dX
                         i=1
</pre><p>where the rescaled to global coordinate differential is:</p>
<pre class="fragment">                         dx/dX = 1 / (X1 - X0)
</pre><p>i.e. the inverse of the corresponding global line dimension.</p>
<h2>Order of Input </h2>
<p>The order of the input values (function + derivative) must be such, that each function/derivative must have its endpoint values clustered together in the order shown below. The function + derivative order must follow the order mentioned above. We thus have the following ordering scheme:</p>
<pre class="fragment">                                      Endpoints

                                          x

                                C (x,y)   0
                                C (x,y)   1
                                 d/dx     0
                                 d/dx     1
</pre><h2>Order of Output </h2>
<p>The location index of the a (i) inside the 4-dimensional vector is given by the following formula:</p>
<pre class="fragment">                          location index of (i)  =  1 + i
</pre><p>NOTES</p>
<p>The array holding initially the function + derivative values and later the tricubic expansion coefficients is passed as an assumed size array (using *). This allows for compact looping over all cubes, even if in the calling routine this array is of different shape. The only drawback of this is that array operations on the assumed size array cannot be performed, i.e. every array element must be addressed by specific indices (like a (i,j) for example), which is the case here. Operations like 'a(1,:) = 1.0' or 'size (a,2)' cannot be done! </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
