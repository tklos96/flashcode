<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/numericalTools/Interpolate/InterpolateMain/Interpolate_cubic3DFd1.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_1e5049951a47af6c299d4f194035013b.html">numericalTools</a></li><li class="navelem"><a class="el" href="dir_eed35f7b641137479b7c948f38ceed3a.html">Interpolate</a></li><li class="navelem"><a class="el" href="dir_06550a40ae0b1b7c18d4f80098946ddc.html">InterpolateMain</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Interpolate_cubic3DFd1.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ac56db0baf6c54eeb3e447f100411a2a7"><td class="memItemLeft" align="right" valign="top">real function, dimension(1:4)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_interpolate_main_2_interpolate__cubic3_d_fd1_8_f90.html#ac56db0baf6c54eeb3e447f100411a2a7">interpolate_cubic3dfd1</a> (a, x, y, z)</td></tr>
<tr class="separator:ac56db0baf6c54eeb3e447f100411a2a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ac56db0baf6c54eeb3e447f100411a2a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac56db0baf6c54eeb3e447f100411a2a7">&#9670;&nbsp;</a></span>interpolate_cubic3dfd1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function, dimension (1:4) interpolate_cubic3dfd1 </td>
          <td>(</td>
          <td class="paramtype">real, dimension (1:64), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>Interpolate_cubic3DFd1 (real, intent (in) :: a (1:64), real, intent (in) :: x, real, intent (in) :: y, real, intent (in) :: z)</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>(i) the i-th tricubic expansion coefficient </td></tr>
    <tr><td class="paramname">x</td><td>rescaled [0,1] x coordinate </td></tr>
    <tr><td class="paramname">y</td><td>rescaled [0,1] y coordinate </td></tr>
    <tr><td class="paramname">z</td><td>rescaled [0,1] z coordinate</td></tr>
  </table>
  </dd>
</dl>
<p>NAME</p>
<p>Interpolate_cubic3DFd1</p>
<p>DESCRIPTION</p>
<p>Calculates the function value and all rescaled 1st derivative values for a triple [x,y,z] of rescaled [0,1] coordinates and the 64 tricubic expansion coefficients. The tricubic expansion reads, for one cube, in terms of rescaled [0,1] x,y,z coordinates: </p><pre class="fragment">                             3   3   3              i j k
                F (x,y,z) = sum sum sum  a (i,j,k) x y z
                            i=0 j=0 k=0
</pre><p>The order of the supplied expansion coefficients a (i,j,k) must be such, that the k index has the highest ranking, followed by the j index and the i index. The overall location index of the a (i,j,k) inside the 64-dimensional vector is given by the following formula: </p><pre class="fragment">          location index of (i,j,k)  =  1 + i + 4j + 16k
</pre><p>The rescaled derivatives are given by the general formula: </p><pre class="fragment">   r+s+t    r  s  t    3   3   3                                 i-r j-s k-t
  d     / dx dy dz  = sum sum sum (i) * (j) * (k) * a (i,j,k) * x   y   z
                      i=r j=s k=t    r     s     t
</pre><p>where the Pochhammer symbols are defined as: </p><pre class="fragment">            (i)  = i * (i-1) * (i-2) * ... * (i-r+1)
               r
</pre><p>The rescaled derivatives are therefore also sums of appropriate expansion coefficients times monomial products. From the general formula we see, that the highest non-zero derivative is of 9-th order.</p>
<p>Since this function is (potentially) called many times from external applications, efficiency is key here and intermediate common summation terms are reused as much as possible. The strategy is partial summation and reduction at each index summation stage. The individual x-,y- and z-coordinate cubic polynomial sections are always evaluated using the Horner scheme to minimize accumulation of computation rounding errors.</p>
<p>NOTES</p>
<p>1) The function is defined as a real array of size 4: </p><pre class="fragment">     Interpolate_cubic3DFd1 (1) = the function value
     Interpolate_cubic3DFd1 (2) = the rescaled d/dx value
     Interpolate_cubic3DFd1 (3) = the rescaled d/dy value
     Interpolate_cubic3DFd1 (4) = the rescaled d/dz value
</pre><p>2) The code checks, if the supplied triple [x,y,z] is rescaled. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
