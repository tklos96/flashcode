<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/physics/sourceTerms/Burn/BurnIntegrate/bn_netIntegrate.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_1cda4e1d5b1cb0a75978177217cc7d6e.html">physics</a></li><li class="navelem"><a class="el" href="dir_a3525317a17f6ac4152495e924587a32.html">sourceTerms</a></li><li class="navelem"><a class="el" href="dir_a0e0ae9f74fc7694fe54488d1d6b9320.html">Burn</a></li><li class="navelem"><a class="el" href="dir_657f9df6b3f6a50a6f1448233ca09191.html">BurnIntegrate</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">bn_netIntegrate.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a5927dbe543be85efc6de6abb00b11110"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bn__net_integrate_8_f90.html#a5927dbe543be85efc6de6abb00b11110">bn_netintegrate</a> (start, stptry, stpmin, stopp, bc, eps, dxsav, kmax, xrk, yrk, xphys, yphys, xlogi, ylogi, nok, nbad, kount, odescal, iprint, derivs, jakob, bjakob, <a class="el" href="interfacesteper.html">steper</a>)</td></tr>
<tr class="separator:a5927dbe543be85efc6de6abb00b11110"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a5927dbe543be85efc6de6abb00b11110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5927dbe543be85efc6de6abb00b11110">&#9670;&nbsp;</a></span>bn_netintegrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bn_netintegrate </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>stptry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>stpmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>stopp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(yphys), intent(inout)&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>eps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dxsav</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(xphys), intent(out)&#160;</td>
          <td class="paramname"><em>xrk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(yphys,xphys), intent(out)&#160;</td>
          <td class="paramname"><em>yrk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>xphys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>yphys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>xlogi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ylogi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nbad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>kount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>odescal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iprint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>derivs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jakob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bjakob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>steper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>subroutine bn_netIntegrate( real(IN) :: start, real(IN) :: stptry, real(IN) :: stpmin, real(IN) :: stopp, real(INOUT) :: bc(:), real(IN) :: eps, real(IN) :: dxsav, integer(IN) :: kmax, real(OUT) :: xrk(:), real(OUT) :: yrk(:,:), ! called with elem integer(IN) :: xphys, integer(IN) :: yphys, integer(IN) :: xlogi, integer(IN) :: ylogi,</p>
<p>integer(OUT) :: nok, integer(OUT) :: nbad, integer(OUT) :: kount, real(IN) :: odescal, integer(IN) :: iprint, procedure(IN):: derivs, procedure(IN):: jakob, procedure(IN):: bjakob, procedure(IN):: steper)</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start</td><td>real(IN) beginning integration point </td></tr>
    <tr><td class="paramname">stptry</td><td>real(IN) suggested first step size </td></tr>
    <tr><td class="paramname">stpmin</td><td>real(IN) minimum allowable step size </td></tr>
    <tr><td class="paramname">stopp</td><td>real(IN) ending integration point </td></tr>
    <tr><td class="paramname">bc(</td><td>) - real(INOUT) initial conditions, array of physical dimension yphys </td></tr>
    <tr><td class="paramname">eps</td><td>real(IN) desired fraction error during the integration </td></tr>
    <tr><td class="paramname">dxsav</td><td>real(IN) incremental vale of indep variable at which to store the solution if zero, solution is stored at every intermediate point if not zero, solution is done and saved at every dxsav point </td></tr>
    <tr><td class="paramname">kmax</td><td>integer(IN) maximum number of solution points to store, kkmax &lt; xphys </td></tr>
    <tr><td class="paramname">xrk(</td><td>) - real(OUT) the independent variable solution array of physical dimension xphys, logical dimension xlogi </td></tr>
    <tr><td class="paramname">yrk(,array</td><td>of physical dimension (yphys,xphys) with logical dimension (ylogi,xlogi) </td></tr>
    <tr><td class="paramname">xphys</td><td>integer(IN) physical size of array xrk,yrk </td></tr>
    <tr><td class="paramname">yphys</td><td>integer(IN) physical size of array yrk </td></tr>
    <tr><td class="paramname">xlogi</td><td>integer(IN) logical size of array xrk,yrk </td></tr>
    <tr><td class="paramname">ylogi</td><td>integer(IN) logical size of array yrk </td></tr>
    <tr><td class="paramname">nok</td><td>integer(OUT) number of succesful steps taken </td></tr>
    <tr><td class="paramname">nbad</td><td>integer(OUT) number of bad steps taken, bad but retried and then succesful </td></tr>
    <tr><td class="paramname">kount</td><td>integer(OUT) total number of steps stored in arrays xrk and yrk </td></tr>
    <tr><td class="paramname">odescal</td><td>real(IN) error scaling factor </td></tr>
    <tr><td class="paramname">iprint</td><td>integer(IN) determines if the solution is printed as it evolves </td></tr>
    <tr><td class="paramname">derivs</td><td>procedure(IN) name of the routine that contains the odes </td></tr>
    <tr><td class="paramname">jakob</td><td>procedure(IN) name of the routine that contains the jacobian of the odes </td></tr>
    <tr><td class="paramname">bjakob</td><td>procedure(IN) name of the routine that sets the pointers of the sparse jacobian </td></tr>
    <tr><td class="paramname">steper</td><td>procedure(IN) name of the routine that will take a single step</td></tr>
  </table>
  </dd>
</dl>
<p>NAME</p>
<p>bn_netIntegrate</p>
<p>DESCRIPTION</p>
<p>ode integrator for stiff odes with an analytic and sparse jacobian.</p>
<p>NOTES this file uses 8 routines to drive the integration of nuclear reaction networks with 2 choices of the time stepper and 2 choices for the linear algebra. routine bn_netIntegrate drives the integration of the odes routine bn_baderMa28 drives a bader-deuflhard step with ma28 algebra routine <a class="el" href="interfacebn__bader_step_ma28.html">bn_baderStepMa28</a> is a bader-deuflhard stepper with ma28 algebra routine bn_baderGift drives a bader-deuflhard step with gift algebra routine bn_baderStepGift is a bader-deuflhard stepper with ma28 algebra routine bn_pzExtr does extrapolations for any of the Step_* routines routine bn_rosenMa28 drives a rosenbrock step with ma28 algebra routine bn_rosenGift drives a rosenbrock step with gift algebra </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
