<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/Grid/GridMain/AMR/paramesh/paramesh4/gr_makeMaskConsistent.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_06beb580571d8da4bd59dee7afe6838a.html">Grid</a></li><li class="navelem"><a class="el" href="dir_a5ba4d35013f375122597140872d1634.html">GridMain</a></li><li class="navelem"><a class="el" href="dir_05ae419e4599d04cada32fb260516b32.html">AMR</a></li><li class="navelem"><a class="el" href="dir_dc00a9966eb127812b09432c10e25e84.html">paramesh</a></li><li class="navelem"><a class="el" href="dir_3b3ed8654821bfdd6a99e96c1e16de76.html">paramesh4</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">gr_makeMaskConsistent.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7e1ab68a316ffa99765bbfcf522244fe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gr__make_mask_consistent_8_f90.html#a7e1ab68a316ffa99765bbfcf522244fe">HAVE_UNK_VARS_FOR_EOS</a></td></tr>
<tr class="separator:a7e1ab68a316ffa99765bbfcf522244fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebcf8199501fab3376017dea4c0d45c2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gr__make_mask_consistent_8_f90.html#aebcf8199501fab3376017dea4c0d45c2">DENS_VAR</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:aebcf8199501fab3376017dea4c0d45c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a4dac1d084981851aa85569f406bca957"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gr__make_mask_consistent_8_f90.html#a4dac1d084981851aa85569f406bca957">gr_makemaskconsistent</a> (gridDataStruct, eosMode, needEos)</td></tr>
<tr class="separator:a4dac1d084981851aa85569f406bca957"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aebcf8199501fab3376017dea4c0d45c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebcf8199501fab3376017dea4c0d45c2">&#9670;&nbsp;</a></span>DENS_VAR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DENS_VAR&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7e1ab68a316ffa99765bbfcf522244fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e1ab68a316ffa99765bbfcf522244fe">&#9670;&nbsp;</a></span>HAVE_UNK_VARS_FOR_EOS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HAVE_UNK_VARS_FOR_EOS</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a4dac1d084981851aa85569f406bca957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dac1d084981851aa85569f406bca957">&#9670;&nbsp;</a></span>gr_makemaskconsistent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gr_makemaskconsistent </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>gridDataStruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>eosMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>needEos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>call gr_makeMaskConsistent(integer,intent(IN) :: gridDataStruct, integer,intent(IN) :: eosMode, logical,intent(OUT) :: needEos)</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gridDataStruct</td><td>indicates a variable that the caller needs, as an index into unk </td></tr>
    <tr><td class="paramname">eosMode</td><td>the eosMode which the calling routine is using. </td></tr>
    <tr><td class="paramname">needEos</td><td>indicates whether Eos should be called after guard cell filling.</td></tr>
  </table>
  </dd>
</dl>
<p>NAME</p>
<p>gr_makeMaskConsistent</p>
<p>DESCRIPTION</p>
<p>For the solvers native to FLASH, this routine provides the service of ensuring that none of essential variables are masked out. For example if mask value is true for a variable that is determined through application of Eos, then it will be made sure that the inputs to Eos also get their values filled. The output parameter "needEos" indicates to the calling routine that the calculated guardcells may not be thermodynamically consistent, and the calling routine should apply Eos.</p>
<p>This subroutine takes account of various runtime parameters and configuration symbols in order to determine the correct logic, including names and existence of grid variables, number of mass fractions, the Eos mode of the caller, whether EOS_YE mode (formerly known as "EOS lite") is used, convertToConsvdForMeshCalls or convertToConsvdInMeshInterp, and gridinterpolation</p>
<p>The logic here is conservative in the following sense: Even if an EOS call could have only small side effects on variables that are basically input (like ENER_VAR or EINT_VAR in MODE_DENS_EI), or if an EOS call change a variable that is basically an input to it only in unusual circumstances (as, e.g., when ENER_VAR or EINT_VAR are inconsistent with each other or other variables), then this routine will determine that the Eos call should be made.</p>
<p>NOTES</p>
<p>Currently this routine is applicable to only cell centered data, since none of the FLASH solvers need consistency check for face centered data.</p>
<p>This routine is MESSY MESSY MESSY and very hard to read. If you don't trust it, turn off runtime parameter enableMaskedGcFill and worry no more about missing some variables in guard cell filling; however, the application may then spend some more time in PARAMESH Grid calls (including MPI calls), exchange more data between processing entities than necessary, and require larger communication buffers.</p>
<p>HISTORY gr_fillGcMask started Jan-2007 KW some tuning Jun-2007 KW</p>
<p>renamed gr_makeMaskConsistent Aug-2007 KW allow for missing EINT_VAR Nov-2007 KW split off less-strict version Dec-2007 KW changed to gr_makeMaskConsistent December-2007 AD changes to take 3T variables into account December-2011 KW introduced call to Grid_guardCellMaskHook September-2013 KW </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
