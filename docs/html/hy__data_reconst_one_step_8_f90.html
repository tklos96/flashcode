<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/physics/Hydro/HydroMain/unsplit/hy_dataReconstOneStep.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_1cda4e1d5b1cb0a75978177217cc7d6e.html">physics</a></li><li class="navelem"><a class="el" href="dir_a1764528f3a110c3b4261dc6e1b9462d.html">Hydro</a></li><li class="navelem"><a class="el" href="dir_c148003c2bda170d95003c2630531f58.html">HydroMain</a></li><li class="navelem"><a class="el" href="dir_af27268307d04430b6d1bac0935d4159.html">unsplit</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">hy_dataReconstOneStep.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;Flash.h&quot;</code><br />
<code>#include &quot;constants.h&quot;</code><br />
<code>#include &quot;UHD.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a49c1e47e4b3ef24a4bca2acc3ae2a6e8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hy__data_reconst_one_step_8_f90.html#a49c1e47e4b3ef24a4bca2acc3ae2a6e8">hy_datareconstonestep</a> (tileDesc, U, loGC, hiGC, order, ix, iy, iz, dt, del, ogravX, ogravY, ogravZ, DivU, FlatCoeff, TransX_updateOnly, TransY_updateOnly, TransZ_updateOnly, Wp, Wn, sig, lambda, leftEig, rghtEig, cellCfl, hy_SpcR, hy_SpcL, hy_SpcSig)</td></tr>
<tr class="separator:a49c1e47e4b3ef24a4bca2acc3ae2a6e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a49c1e47e4b3ef24a4bca2acc3ae2a6e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49c1e47e4b3ef24a4bca2acc3ae2a6e8">&#9670;&nbsp;</a></span>hy_datareconstonestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hy_datareconstonestep </td>
          <td>(</td>
          <td class="paramtype">type(grid_tile_t), intent(in)&#160;</td>
          <td class="paramname"><em>tileDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:,:), pointer&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(mdim), intent(in)&#160;</td>
          <td class="paramname"><em>loGC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(mdim), intent(in)&#160;</td>
          <td class="paramname"><em>hiGC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdim), intent(in)&#160;</td>
          <td class="paramname"><em>del</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(logc(iaxis):higc(iaxis),                  logc(jaxis):higc(jaxis),                  logc(kaxis):higc(kaxis)), intent(in), target&#160;</td>
          <td class="paramname"><em>ogravX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(logc(iaxis):higc(iaxis),                  logc(jaxis):higc(jaxis),                  logc(kaxis):higc(kaxis)), intent(in), target&#160;</td>
          <td class="paramname"><em>ogravY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(logc(iaxis):higc(iaxis),                  logc(jaxis):higc(jaxis),                  logc(kaxis):higc(kaxis)), intent(in), target&#160;</td>
          <td class="paramname"><em>ogravZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(logc(iaxis):higc(iaxis),                  logc(jaxis):higc(jaxis),                  logc(kaxis):higc(kaxis)), intent(in)&#160;</td>
          <td class="paramname"><em>DivU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ndim,logc(iaxis):higc(iaxis),                       logc(jaxis):higc(jaxis),                       logc(kaxis):higc(kaxis)), intent(in)&#160;</td>
          <td class="paramname"><em>FlatCoeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>TransX_updateOnly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>TransY_updateOnly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>TransZ_updateOnly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(hy_varinummax,           ndim), intent(out)&#160;</td>
          <td class="paramname"><em>Wp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(hy_varinummax,           ndim), intent(out)&#160;</td>
          <td class="paramname"><em>Wn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(hy_varinummax,           ndim), intent(out)&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(              hy_wavenum,ndim), intent(out)&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(hy_varinum,   hy_wavenum,ndim), intent(out)&#160;</td>
          <td class="paramname"><em>leftEig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(hy_varinum,   hy_wavenum,ndim), intent(out)&#160;</td>
          <td class="paramname"><em>rghtEig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout), optional&#160;</td>
          <td class="paramname"><em>cellCfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>hy_SpcR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>hy_SpcL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>hy_SpcSig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>hy_dataReconstOneStep(integer(IN) :: block, integer(IN) :: blkLimitsGC(:,:), integer(IN) :: order, integer(IN) :: ix, integer(IN) :: iy, integer(IN) :: iz, real(IN) :: dt, real(IN) :: del(MDIM), real(IN) :: ogravX(:,:,:), real(IN) :: ogravY(:,:,:), real(IN) :: ogravZ(:,:,:), real(IN) :: DivV(:,:,:), real(IN) :: FlatCoeff(:,:,:,:), logical(IN) :: TransX_updateOnly, logical(IN) :: TransY_updateOnly, logical(IN) :: TransZ_updateOnly, real(OUT) :: Wp(HY_VARINUMMAX,NDIM), real(OUT) :: Wn(HY_VARINUMMAX,NDIM), real(OUT) :: sig(HY_VARINUMMAX,NDIM), real(OUT) :: lambda(HY_WAVENUM,NDIM), real(OUT) :: leftEig(HY_VARINUM,HY_VARINUM,NDIM), real(OUT) :: rghtEig(HY_VARINUM,HY_WAVENUM,NDIM), OPTIONAL,real,pointer:: hy_SpcR(:,:,:,:,:), OPTIONAL,real,pointer:: hy_SpcL(:,:,:,:,:), OPTIONAL,real,pointer:: hy_SpcSig(:,:,:,:,:))</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block</td><td>local block ID </td></tr>
    <tr><td class="paramname">blkLimitsGC</td><td>block limits including guardcells </td></tr>
    <tr><td class="paramname">order</td><td>order of reconstruction method </td></tr>
    <tr><td class="paramname">ix,iy,iz</td><td>local indices </td></tr>
    <tr><td class="paramname">dt</td><td>timestep </td></tr>
    <tr><td class="paramname">del</td><td>deltas in each {x,y,z} direction </td></tr>
    <tr><td class="paramname">ogravX,ogravY,ogravZ</td><td>gravity components at n </td></tr>
    <tr><td class="paramname">DivV</td><td>divergence of velocity fields used for hybrid order method </td></tr>
    <tr><td class="paramname">FlatCoeff</td><td>flattening parameters </td></tr>
    <tr><td class="paramname">TransX_updateOnly</td><td>a switch for a selective transverse update in x direction </td></tr>
    <tr><td class="paramname">TransY_updateOnly</td><td>a switch for a selective transverse update in y direction </td></tr>
    <tr><td class="paramname">TransZ_updateOnly</td><td>a switch for a selective transverse update in z direction </td></tr>
    <tr><td class="paramname">Wp,Wn</td><td>right (plus) and left(negative) Riemann states </td></tr>
    <tr><td class="paramname">sig</td><td>a transverse flux term </td></tr>
    <tr><td class="paramname">lambda</td><td>eigenvalue </td></tr>
    <tr><td class="paramname">leftEig</td><td>left eigenvector </td></tr>
    <tr><td class="paramname">rghtEig</td><td>right eigenvector </td></tr>
    <tr><td class="paramname">hy_SpcR,hy_SpcL,hy_SpcSig</td><td>pointers of Riemann states for Species and mass scalar</td></tr>
  </table>
  </dd>
</dl>
<p>NAME</p>
<p>hy_dataReconstOneStep</p>
<p>DESCRIPTION</p>
<p>This onestep data reconstruction routine evolves the cell centered values by dt/2 time step at each cell interface using characteristic tracing method based on 2nd order MUSCL-Hancock, 3rd order PPM, or 5th order WENO schemes. For MHD, the cell interface values are reconstructed in multidimensional fashion with inclusions of MHD multidimensional terms that are proportional to divB for the unsplit MHD implementation.</p>
<p>REFERENCES</p>
<ul>
<li>Toro, Riemann Solvers and Numerical Methods for Fluid Dynamics, Springer, 1997</li>
<li>Lee, D., Ph.D. Dissertation, Univ. of MD, 2006</li>
<li>Lee, D. and Deane, A., "An Unsplit Staggered Mesh Scheme for Multidimensional
                            Magnetohydrodynamics", 228 (2009), 952-975, JCP</li>
<li>Stone, Gardiner, Teuben, Hawley, Simon, "Athena: A new code for astrophysical MHD" arXiv:0804.0402v1 [astro-ph] 2 Apr 2008</li>
<li>Colella and Woodward, 54, 174 (1984), JCP</li>
<li>Colella, 87, 171-200 (1990), JCP </li>
</ul>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
