<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/physics/Hydro/HydroMain/unsplit/hy_updateSolution.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_1cda4e1d5b1cb0a75978177217cc7d6e.html">physics</a></li><li class="navelem"><a class="el" href="dir_a1764528f3a110c3b4261dc6e1b9462d.html">Hydro</a></li><li class="navelem"><a class="el" href="dir_c148003c2bda170d95003c2630531f58.html">HydroMain</a></li><li class="navelem"><a class="el" href="dir_af27268307d04430b6d1bac0935d4159.html">unsplit</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">hy_updateSolution.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;constants.h&quot;</code><br />
<code>#include &quot;Flash.h&quot;</code><br />
<code>#include &quot;UHD.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a1b7cca9386ce64f8e979f89386d4cf30"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hy__update_solution_8_f90.html#a1b7cca9386ce64f8e979f89386d4cf30">hy_updatesolution</a> (tileDesc, Uin, Uout, del, timeEndAdv, dt, dtOld, sweepOrder)</td></tr>
<tr class="separator:a1b7cca9386ce64f8e979f89386d4cf30"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a1b7cca9386ce64f8e979f89386d4cf30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b7cca9386ce64f8e979f89386d4cf30">&#9670;&nbsp;</a></span>hy_updatesolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hy_updatesolution </td>
          <td>(</td>
          <td class="paramtype">type(grid_tile_t), intent(in)&#160;</td>
          <td class="paramname"><em>tileDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:,:), pointer&#160;</td>
          <td class="paramname"><em>Uin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:,:), pointer&#160;</td>
          <td class="paramname"><em>Uout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdim), intent(in)&#160;</td>
          <td class="paramname"><em>del</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>timeEndAdv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dtOld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sweepOrder</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>call hy_updateSolution(Grid_tile_t(IN) :: tileDesc, real,POINTER(in),dimension(:,:,:,:) :: Uin, real,POINTER(in),dimension(:,:,:,:) :: Uout, real(IN) :: del(MDM), real(IN) :: timeEndAdv, real(IN) :: dt, real(IN) :: dtOld, integer(IN) :: sweepOrder)</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blockDesc</td><td>indentifies and describes the current block </td></tr>
    <tr><td class="paramname">Uin</td><td>pointer to one block's worth of cell data; this represents the input data to the current hydro time step. Uout must be an associated pointer. See NOTES below for more info on the relation between Uin and Uout. </td></tr>
    <tr><td class="paramname">Uout</td><td>pointer to one block's worth of cell data; this represents the output data of the current hydro time step. Uout must be an associated pointer. See NOTES below for more info on the relation between Uin and Uout. </td></tr>
    <tr><td class="paramname">timeEndAdv</td><td>end time </td></tr>
    <tr><td class="paramname">dt</td><td>timestep </td></tr>
    <tr><td class="paramname">dtOld</td><td>old timestep </td></tr>
    <tr><td class="paramname">sweepOrder</td><td>dummy argument for the unsplit scheme, just a dummy </td></tr>
    <tr><td class="paramname">variable</td><td>to be consistent with a top layer stub function</td></tr>
  </table>
  </dd>
</dl>
<p>NAME</p>
<p>hy_updateSolution</p>
<p>DESCRIPTION</p>
<p>Performs physics update to the solution on a block in a directionally unsplit fashion.</p>
<p>Fluxes must have been computed before this routine is called. This implementation expects fluxes to be stored under the responsibility of the Grid unit, and accessed with pairs of Grid_getFluxPtr/Grid_releaseFluxPtr calls.</p>
<p>The blockDesc argument tells this routine on which block to operate.</p>
<p>dt gives the timestep through which this update should advance, and timeEndAdv tells the time that this update will reach when it finishes. dtOld gives the previously taken timestep.</p>
<p>NOTES</p>
<h2>Uin and Uout </h2>
<ol type="1">
<li>Uin and Uout can point to the same storage. Actually this is the way mostly tested.</li>
<li>Schematically (omitting any bothersome details about directionality, about whether solution variables are in primitive or conservative form and fluxes are really fluxes or flux densities, etc.), the function of this routine is to do the following, in order:</li>
</ol>
<p>(a) Conservative Update: <b>For variables that have corresponding fluxes</b></p>
<p>Uout := Uin + fluxes * dt/dx</p>
<p>(not, for example, Uout += fluxes * dt/dx). <b>Variables in Uout that do not have corresponding fluxes</b>, on the other hand, are not modified in this part (a). The list of variables that are considered to have corresponding fluxes is: !!DEV: TBD</p>
<p>(b) Additional Solution Modifications: These are applied to the variables now in Uout, and can include</p><ul>
<li>calling hy_unsplitUpdateMultiTemp (for 3T Hydro, not currently implemented here);</li>
<li>calling hy_energyFix (to update internal energies, and possibly other fixups);</li>
<li>calling hy_unitConvert (for obscure MHD purposes);</li>
<li>call Eos_wrapped (with mode=hy_eosModeAfter, to bring solution variables in Uout into a thermodynamically consistent state).</li>
</ul>
<h2>Other Notes </h2>
<p>The preprocessor symbols MDIM, LOW, HIGH are defined in constants.h . </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
