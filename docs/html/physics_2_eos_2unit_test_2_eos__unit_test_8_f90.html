<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/physics/Eos/unitTest/Eos_unitTest.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_1cda4e1d5b1cb0a75978177217cc7d6e.html">physics</a></li><li class="navelem"><a class="el" href="dir_f5770a1015dc92cf5838be47b46d02c6.html">Eos</a></li><li class="navelem"><a class="el" href="dir_c94bac005f5074d15e6acb69ab9645ce.html">unitTest</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Eos_unitTest.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a7385fa0dd2a65bc74f017e8567661284"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="physics_2_eos_2unit_test_2_eos__unit_test_8_f90.html#a7385fa0dd2a65bc74f017e8567661284">eos_unittest4</a> (fileUnit, perfect, solnData, blkLimits, blockDesc)</td></tr>
<tr class="separator:a7385fa0dd2a65bc74f017e8567661284"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a7385fa0dd2a65bc74f017e8567661284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7385fa0dd2a65bc74f017e8567661284">&#9670;&nbsp;</a></span>eos_unittest4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine eos_unittest4 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>fileUnit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(out)&#160;</td>
          <td class="paramname"><em>perfect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:,:), pointer&#160;</td>
          <td class="paramname"><em>solnData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(low:high,mdim), intent(in)&#160;</td>
          <td class="paramname"><em>blkLimits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structblock__metadata_1_1block__metadata__t.html">block_metadata_t</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>blockDesc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>call Eos_unitTest(integer(IN) :: fileUnit, logical(OUT) :: perfect</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fileUnit</td><td>unit number for file opened by the unitTest/Eos setup in which to write results of the test </td></tr>
    <tr><td class="paramname">perfect</td><td>indicates test ran without error is true. </td></tr>
    <tr><td class="paramname">blockDesc</td><td>describes a block on which we are being called. For informational messages ony, can be omitted. eintSwitch a rarely used switch which ensures that internal energy calculations maintain sufficient precision. Important only if energyTotal is dominated by energyKinetic. NAME</td></tr>
  </table>
  </dd>
</dl>
<p>Eos_unitTest</p>
<p>DESCRIPTION</p>
<p>This function is the unit test for the Eos unit. It is invoked in the setup unitTest/Eos. The Config file for Eos unit test setup requests a few extra variables in the main grid data structure for Grid scope temporary storage. The Simulation_initBlock of the Eos unit test initializes density in the right place for the DENS_VAR variable (see Flash.h for DENS_VAR, TEMP_VAR etc definitions), and temperature and pressure in the extra storage space CTMP_VAR and CPRS_VAR. The physical quantities at this point are not in thermal equilibrium.</p>
<p>The Eos_unit test starts by copying the initialized temperature into the TEMP_VAR location and calling the Eos_wrapped function with eosMode = MODE_DENS_TEMP, where density and temperature are given and pressure and energy are calculated. Now PRES_VAR and EINT_VAR contain values of pressure and internal energy that are in thermal equilibrium, and the pressure values are not necessarily what was stored in the extra storage space during intialization.</p>
<p>At this point in time three quantities; temperature, pressure and energy are saved in the extra storage requested by the unitTest/Eos setup, say OTMP_VAR, OPRS_VAR and OENT_VAR. Now the Eos_unitTest function calls Eos_wrapped with eosMode = MODE_DENS_PRES, followed by eosMode= MODE_DENS_EI. If the newly calculated values of temperature, pressure and energy are the same as those saved in OTMP_VAR, OPRS_VAR and OENT_VAR, then we can conclude that the Eos is working in MODE_DENS_PRES and MODE_DENS_EI modes. However, we still can't say anything about the MODE_DENS_TEMP mode. So we repeat the process by copying CPRS_VAR into PRES_VAR and calling Eos_wrapped with MODE_DENS_PRES. We again save the calculated values in the extra storage and make two more Eos_wrapped calls with the remaining two modes. This time if the new and old values of variables compare, we can conclude that MODE_DENS_TEMP works too, and hence the unit test is successful.</p>
<p>A final test calculates the optional derivates by setting the mask argument to Eos equal to true. The values of these arguments are not tested in any way. The unitTest simply makes sure that they can be calculated without NaNs or the like. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
