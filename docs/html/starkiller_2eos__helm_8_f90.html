<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH5 Test: fortran/FLASH5/source/physics/Eos/EosMain/Helmholtz_starkiller/eos_helm.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLASH5 Test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d95adc37effe2d0447790667f945c24.html">fortran</a></li><li class="navelem"><a class="el" href="dir_aaca5e2157f58805ddf087a6c1d4d986.html">FLASH5</a></li><li class="navelem"><a class="el" href="dir_d9542af6519f0ca27bc6117ad523d5c6.html">source</a></li><li class="navelem"><a class="el" href="dir_1cda4e1d5b1cb0a75978177217cc7d6e.html">physics</a></li><li class="navelem"><a class="el" href="dir_f5770a1015dc92cf5838be47b46d02c6.html">Eos</a></li><li class="navelem"><a class="el" href="dir_b145db4f0452b3292a7b3608d2d94447.html">EosMain</a></li><li class="navelem"><a class="el" href="dir_99cc7849dae07e888649aa6fff57d370.html">Helmholtz_starkiller</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">eos_helm.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;constants.h&quot;</code><br />
<code>#include &quot;Flash.h&quot;</code><br />
<code>#include &quot;Eos.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:add6e3f1fb96649f813b1b07ec5bc0b16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="starkiller_2eos__helm_8_f90.html#add6e3f1fb96649f813b1b07ec5bc0b16">EOS_LESSOPERATIONS</a></td></tr>
<tr class="separator:add6e3f1fb96649f813b1b07ec5bc0b16"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a1f4056590781e1394a14f57e3c5eca1a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="starkiller_2eos__helm_8_f90.html#a1f4056590781e1394a14f57e3c5eca1a">eos_helm</a> (eos_jlo, eos_jhi, mask)</td></tr>
<tr class="separator:a1f4056590781e1394a14f57e3c5eca1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="add6e3f1fb96649f813b1b07ec5bc0b16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add6e3f1fb96649f813b1b07ec5bc0b16">&#9670;&nbsp;</a></span>EOS_LESSOPERATIONS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EOS_LESSOPERATIONS</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a1f4056590781e1394a14f57e3c5eca1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f4056590781e1394a14f57e3c5eca1a">&#9670;&nbsp;</a></span>eos_helm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine eos_helm </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>eos_jlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>eos_jhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(eos_vars+1:eos_num), intent(in), optional&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p></p>
<p>call eos_helm(integer(IN) :: eos_jlo, integer(IN) :: eos_jhi, optional, logical(IN) :: mask(EOS_VARS+1:EOS_NUM) )</p>
<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">eos_jlo</td><td>low index of calculation range </td></tr>
    <tr><td class="paramname">eos_jhi</td><td>high index of calculation range </td></tr>
    <tr><td class="paramname">mask</td><td>Mask is a logical array the size of EOS_DERIVS (number of partial derivatives that can be computed, defined in Eos.h), where each index represents a specific partial derivative that can be calculated by the Eos unit. A .true. value in mask results in the corresponding derivative being calculated and returned. It should preferably be dimensioned as </td></tr>
    <tr><td class="paramname">mask(EOS_VARS+1</td><td>EOS_NUM) in the calling routine to exactly match the arguments declaration in Eos Unit. Note that the indexing of mask does not begin at 1, but rather at one past the number of basic variables. The Helmholtz EOS kernel calculation ignores the mask setting and calculates all derivatives, whether needed or not. This routine does not return derivatives if the mask is requested, but the calculation is not speeded up by setting the mask.</td></tr>
  </table>
  </dd>
</dl>
<p>NAME</p>
<p>eos_helm</p>
<p>DESCRIPTION</p>
<p>given a temperature temp [K], density den [g/cm**3], and a composition characterized by abar and zbar, this routine returns some of the other thermodynamic quantities. of prime interest is the pressure [erg/cm**3], specific thermal energy [erg/gr], and their derivatives with respect to temperature and density.</p>
<p>NOTE that this routine does not have any Flash3 eosMode other than MODE_DENS_TEMP. So the initial temperature and density input to Eos() for the Helmholtz unit must be a good guess, or the algorithms will never converge.</p>
<p>for opacity purposes, the number density of electron-positrons, the chemical potential of the electrons, and the pressure due to electrons and positrons is also returned</p>
<p>this routine uses planckian photons, an ideal gas of ions, and a fully ionized electron-positron gas with an arbitrary degree of relativity and degeneracy. interpolation in a table of the helmholtz free energy is used to return the electron-positron thermodynamic quantities.</p>
<p>references: cox &amp; giuli chapter 24 ; timmes &amp; swesty apj 1999</p>
<p>NOTES</p>
<p>equation of state communication through eos_vecData</p>
<p>btemp = temperature den = density abar = average number of nucleons per nuclei zbar = average number of protons per nuclei z2bar = square of zbar ytot1 = total number of moles per gram ye = electron mole number</p>
<p>Since this subroutine has an optional argument, an explicit interface is needed. Calling program units should therefore have a line like use eos_helmInterface, ONLY : eos_helm no matter whether they call eos_helm with or without the optional mask argument. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
